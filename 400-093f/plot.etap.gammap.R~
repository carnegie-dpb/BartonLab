source("REV-known-targets.R")
source("STM-known-targets.R")

fits["AT2G36307",]$symbol = "ZPR4"

if (CONDITION=="GR-REV") {
    known.targets = REV.targets
} else if (CONDITION=="GR-STM") {
    known.targets = STM.targets
}

##
## Make a nice plot of etap.hat vs gammap
##

## full scale
plot(fits$gammap, fits$etap.hat, main=CONDITION)
text(fits$gammap, fits$etap.hat, fits$symbol, cex=0.5, pos=4)
text(fits$gammap, fits$etap.hat, fits$group, cex=0.5, pos=2)
text(fits$gammap, fits$etap.hat, round(fits$meandata,2), cex=0.5, pos=1)
points(fits$gammap[known.targets], fits$etap.hat[known.targets], pch=19, col="red")
text(fits$gammap[known.targets], fits$etap.hat[known.targets], fits$symbol[known.targets], cex=0.5, pos=4, col="red")
text(fits$gammap[known.targets], fits$etap.hat[known.targets], fits$group[known.targets], cex=0.5, pos=2, col="red")
text(fits$gammap[known.targets], fits$etap.hat[known.targets], round(fits$meandata[known.targets],2), cex=0.5, pos=1, col="red")

## ## zoom
## plot(fits$gammap, fits$etap.hat, ylim=c(-0.1,0.4))
## text(fits$gammap, fits$etap.hat, fits$symbol, cex=0.5, pos=4)
## text(fits$gammap, fits$etap.hat, fits$group, cex=0.5, pos=2)
## points(fits$gammap[known.targets], fits$etap.hat[known.targets], pch=19, col="red")
## text(fits$gammap[known.targets], fits$etap.hat[known.targets], fits$symbol[known.targets], cex=0.5, pos=4, col="red")
## text(fits$gammap[known.targets], fits$etap.hat[known.targets], fits$group[known.targets], cex=0.5, pos=2, col="red")
